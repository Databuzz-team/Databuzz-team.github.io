<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Databuzz, Databuzz.team@gmail.com"><title><Tensorflow> Tensorflow에서 Graph와 Session의 차이 · Databuzz's Tech Blog</title><!-- hexo-inject:begin --><!-- hexo-inject:end --><meta name="description" content="Tensorflow에서 Graph와 Session의 차이
      
      
        이 컨텐츠는 DanTheTech 블로그로 옮겨졌습니다!
        불편을 끼쳐드려 죄송합니다. 이 링크를 클릭하셔서 확인해주시면 정말 감사하겠습니다.
        앞으"><meta name="keywords" content="DataScience"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta content="hA9pHsXOdxxbLoAhWc2b_3tvhy-58l3vHmH8dw3WVkA" name="google-site-verification"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/danial/tensorflow.jpeg" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/solid.css" integrity="sha384-VGP9aw4WtGH/uPAOseYxZ+Vz/vaTb1ehm1bwx92Fm8dTrE+3boLfF1SpAtB1z7HW" crossorigin="anonymous"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/fontawesome.css" integrity="sha384-1rquJLNOM3ijoueaaeS5m+McXPJCGdr5HcA03/VHXxcp2kX2sUrQDmFc3jR5i/C7" crossorigin="anonymous"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/brands.css" integrity="sha384-rf1bqOAj3+pw6NqYrtaE1/4Se2NBwkIfeYbsFdtiR6TQz0acWiwJbv1IM/Nt/ite" crossorigin="anonymous"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/fontawesome.css" integrity="sha384-1rquJLNOM3ijoueaaeS5m+McXPJCGdr5HcA03/VHXxcp2kX2sUrQDmFc3jR5i/C7" crossorigin="anonymous"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/reset.css"><link rel="stylesheet" href="/css/new.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Luckiest+Guy|Stylish|Boogaloo"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-127200932-1"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/custom.js"></script><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ TeX: { extensions: ["color.js"] }});</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/main_logo_new.png" style="width:127px;"><h3 class="sidebar_title" title="">DataBuzz</h3><div class="description"><p class="title_description">Awesome Tech Blog<a class="rss-icon-a" href="https://databuzz-team.github.io/atom" target="__blank"><i class='fas fa-rss rss-icon'></i></a></p></div></div></div><div class="featured-tags-wrap"><h1 class="featured-tags-title">FEATURED TAGS</h1><ul class="featured-tags-ul"><li class="featured-tags-li tag-li-detail"> Data Science </li><li class="featured-tags-li tag-li-detail"> Hexo </li><li class="featured-tags-li tag-li-detail"> Mathjax </li><li class="featured-tags-li tag-li-detail"> Tech News </li><li class="featured-tags-li tag-li-detail"> Git </li><li class="featured-tags-li tag-li-detail"> Machine Learning </li><li class="featured-tags-li tag-li-detail"> Artificial Intelligence </li><li class="featured-tags-li tag-li-detail"> Deep Learning </li><li class="featured-tags-li tag-li-detail"> Tensorflow </li><li class="featured-tags-li tag-li-detail"> Catboost </li><li class="featured-tags-li tag-li-detail"> Scikit Learn </li><li class="featured-tags-li tag-li-detail"> Hyperparameter </li><li class="featured-tags-li tag-li-detail"> Graph </li><li class="featured-tags-li tag-li-detail"> Session </li><li class="featured-tags-li tag-li-detail"> Markdown </li><li class="featured-tags-li tag-li-detail"> Regression </li><li class="featured-tags-li tag-li-detail"> Neural Network </li><li class="featured-tags-li tag-li-detail"> Portfolio </li><li class="featured-tags-li tag-li-detail"> Resume </li><li class="featured-tags-li tag-li-detail"> Deep Neural Networks </li><li class="featured-tags-li tag-li-detail"> Back Propagation </li></ul></div><div class="footer"><span>@ 2018 DataBuzz All Rights Reserved</span><br><span>Hexo Theme by </span><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><span>&nbsp;&nbsp;&nbsp; Edited by </span><a href="https://danialdaehyunnam.github.io"> Danial Nam </a></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/"><i class="fas fa-home nav-icon"></i>Home</a></li><li><a href="/archives"><i class="fas fa-archive nav-icon"></i>Archives</a></li><li><a href="/tags-and-authors"><i class="fas fa-user-tag nav-icon"></i>Tags & Authors</a></li><li><a href="/about-us"><i class="fas fa-building nav-icon"></i>About Us</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left back-btn-icon" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/sun.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>&lt;Tensorflow&gt; Tensorflow에서 Graph와 Session의 차이</a></h3></div><div class="post-content post-detail"><div style="display: none;">
<!-- hexo-inject:begin --><!-- hexo-inject:end --><img src="/images/danial/tensorflow.jpeg">
</div>

<div class="danthetech-intro-wrap">
  <a class="danthetech-intro-a" href="https://danthetech.netlify.com/DataScience/tensorflow-difference-between-graph-and-session/" target="_blank" rel="noopener">
    <img class="danthetech-img-wrap" src="/images/danial/tensorflow.jpeg">
    <div class="danthetech-p-wrap">
      <h1 class="danthetech-intro-title">
        Tensorflow에서 Graph와 Session의 차이
      </h1>
      <p class="danthetech-intro-p">
        <span class="danthetech-intro-strong">이 컨텐츠는 DanTheTech 블로그로 옮겨졌습니다!</span>
        불편을 끼쳐드려 죄송합니다. 이 링크를 클릭하셔서 확인해주시면 정말 감사하겠습니다.
        앞으로도 DataScience, App Development부터 DevOps관련 자료 등 도움될만한 글이 많이 올릴 예정이니 자주 들려주세요! :)
      </p>
    </div>
  </a>
</div>


<h3 id="About"><a href="#About" class="headerlink" title="About"></a>About</h3><p>Tensorflow로 이것저것 도전하면서<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ValueError: Operation name: <span class="string">"init"</span></span><br><span class="line">op: <span class="string">"NoOp"</span></span><br><span class="line">input: <span class="string">"^val/Assign"</span></span><br><span class="line"> <span class="keyword">is</span> <span class="keyword">not</span> an element of this graph.</span><br></pre></td></tr></table></figure></p>
<p>오류라던가<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tensor Tensor(<span class="string">"val:0"</span>, shape=(), dtype=int32_ref) <span class="keyword">is</span> <span class="keyword">not</span> an element of this graph.</span><br></pre></td></tr></table></figure></p>
<p>와 같은 오류들을 마주치면서 graph에 대해서 좀 더 깊게 이해하는 것이 좋겠다는 생각이 들었다.</p>
<p>그래서 찾던 도중에 좋은 예제가 있어서 이번 포스팅을 통해서 소개하고자한다.</p>
<h3 id="Graph"><a href="#Graph" class="headerlink" title="Graph?"></a>Graph?</h3><ol>
<li>Graph는 operation을 정의한 것을 말한다. Tensor와 Node간의 계산 등을 포함한 설계도를 의미하며 Data와는 관계가 없다.</li>
<li>Graph를 Session을 통해서 실행할 때, 우리가 layer간에 설치한 dimensions나 type등을 체크하며 문제가 있을시에는 예외를 발생시킨다.</li>
<li>Graph를 실행하기 위해서는 Data를 feed 해야한다.</li>
</ol>
<h3 id="Session"><a href="#Session" class="headerlink" title="Session?"></a>Session?</h3><p>Graph에게 전화를 거는 것이다. 특정 Graph에게 전화를 걸고 우리가 원하는 결과를 얻기위해 일을 시키는 것이라고 생각하면 된다.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.Session(graph=graph_we_want_to_connect) <span class="keyword">as</span> sess:</span><br><span class="line">  sess.run([op], feed_dict=&#123;data:data&#125;)</span><br></pre></td></tr></table></figure></p>
<h3 id="실습"><a href="#실습" class="headerlink" title="실습"></a>실습</h3><p>위의 뜻을 해석해보면 다양한 모델(Graph)을 만들고 세션마다 원하는 모델에 연결해서 학습을 진행할 수 있다는 것이다.</p>
<p>무슨 뜻인지 아래의 예제를 통해서 확인해보자.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">graph_1 = tf.Graph()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> graph_1.as_default():</span><br><span class="line">  W_1 = tf.Variable(<span class="number">100</span>, name=<span class="string">"graph_1_W"</span>)</span><br><span class="line">  init_graph_1 = tf.global_variables_initializer()</span><br><span class="line"></span><br><span class="line">graph_2 = tf.Graph()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> graph_2.as_default():</span><br><span class="line">  W_2 = tf.Variable(<span class="number">200</span>, name=<span class="string">"graph_2_W"</span>)</span><br><span class="line">  init_graph_2 = tf.global_variables_initializer()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session(graph=graph_1) <span class="keyword">as</span> sess:</span><br><span class="line">  sess.run(init_graph_1)</span><br><span class="line">  print(sess.run(W_1))</span><br><span class="line"></span><br><span class="line"><span class="comment"># output 100</span></span><br></pre></td></tr></table></figure>
<p>이 경우에 아래처럼 실행하면<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.Session(graph=graph_1) <span class="keyword">as</span> sess:</span><br><span class="line">  sess.run(init_graph_2)</span><br><span class="line">  print(sess.run(W_1))</span><br></pre></td></tr></table></figure></p>
<p>아래같은 오류가 난다.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Operation name: <span class="string">"init"</span></span><br><span class="line">op: <span class="string">"NoOp"</span></span><br><span class="line">input: <span class="string">"^graph_2_W/Assign"</span></span><br><span class="line"> <span class="keyword">is</span> <span class="keyword">not</span> an element of this graph.</span><br></pre></td></tr></table></figure></p>
<p>오류 의미 그대로이다. 우리가 실행하고자 한 init_graph_2가 graph_1에 해당하는 것이 아니어서 오류가 발생한 것이다.</p>
<p>변수의 경우도 마찬가지로 아래처럼 실행하면 오류가 발생한다.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.Session(graph=graph_1) <span class="keyword">as</span> sess:</span><br><span class="line">  sess.run(init_graph_1)</span><br><span class="line">  print(sess.run(W_2))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tensor(<span class="string">"graph_2_W:0"</span>, shape=(), dtype=int32_ref) <span class="keyword">is</span> <span class="keyword">not</span> an element of this graph.</span><br></pre></td></tr></table></figure>
<h3 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h3><p>Graph는 모델이며, Session은 원하는 모델을 선택하여 전화를 걸고 일을 시키는 행위를 말한다.</p>
<h3 id="Related-Posts"><a href="#Related-Posts" class="headerlink" title="Related Posts"></a>Related Posts</h3><p><a href="https://danthetech.netlify.com/DataScience/tensorflow-difference-between-graph-and-session/" target="_blank" rel="noopener"><tensorflow> Tensorflow에서 Graph와 Session의 차이</tensorflow></a><br><a href="http://goingmyway.cn/2017/07/14/Understanding-Session-and-Graph/" target="_blank" rel="noopener">Understanding Session and Graph</a></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date tag-not-hover">2019-01-30</span><i class="fa fa-comment-o"></i><a href="/2019/01/30/difference-between-graph-and-session/#comments">Comments</a><!-- i.fas.fa-pencil-alt--><!-- a.tag(href=config.root + item.path, title= item.name)!= "Written by " + '<img class="post-footer-author" src="/images/avatar/' + png_name + '.png"> ' + item.name + " "--><a class="tag tag-not-hover">Written by <img class="post-footer-author" src="/images/avatar/danial-nam.png"> Danial Nam </a><br><i class="fa fa-tag"></i><!-- a.tag(href=config.root + item.path, title= item.name)= "#" + item.name + " "--><a class="tag tag-not-hover">#Deep Learning </a><!-- a.tag(href=config.root + item.path, title= item.name)= "#" + item.name + " "--><a class="tag tag-not-hover">#Tensorflow </a><!-- a.tag(href=config.root + item.path, title= item.name)= "#" + item.name + " "--><a class="tag tag-not-hover">#Graph </a><!-- a.tag(href=config.root + item.path, title= item.name)= "#" + item.name + " "--><a class="tag tag-not-hover">#Session </a><div class="share-to-social">Share on <div class="sharer" id="sharer"> <div class="sharer-item" data-n="facebook"><i class="fab fa-facebook-f"></i></div><div class="sharer-item" data-n="twitter"><i class="fab fa-twitter"></i></div><div class="sharer-item" data-n="pinterest"><i class="fab fa-pinterest"></i></div></div></div></div></div></div></div><div class="share"></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2019/01/30/Basic-dnn-using-tensorflow/" title="&lt;Deep Learning&gt; Tensorflow로 DNN 모델링하며 Good Practice에 대해서 생각해보자">Previous post</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/12/27/Back-Propagation-Part-2/" title="&lt;Neural Network&gt; 인공신경망에 대한 이해(Part 2 - Back Propagation)">Next post</a></li></ul></div><a id="comments"></a><div id="disqus_thread"></div><script>var disqus_shortname = 'Databuzz';
var disqus_identifier = '2019/01/30/difference-between-graph-and-session/';
var disqus_title = '&lt;Tensorflow&gt; Tensorflow에서 Graph와 Session의 차이';
var disqus_url = 'https://databuzz-team.github.io/2019/01/30/difference-between-graph-and-session/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script></div></div></div></div><a href="#" id="back-to-top" title="Back to top"><i class="fas fa-angle-up"></i></a><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>